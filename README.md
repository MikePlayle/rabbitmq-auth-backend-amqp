TODO: document, make configurable, make reliable.

